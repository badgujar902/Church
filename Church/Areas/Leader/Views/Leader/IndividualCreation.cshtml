@model Church.Models.Individual
@{
    ViewBag.Title = "IndividualCreation";
    Layout = "~/Areas/Leader/Views/Shared/_LeaderLayout.cshtml";
}
<script src="~/scripts/jquery-1.10.2.js"></script>
<script src="~/scripts/jquery-1.10.2.min.js"></script>
<script src="~/scripts/jquery.validate.js"></script>
<script src="~/scripts/jquery.validate.min.js"></script>
<script src="~/assets/plugins/sweetalert/dist/sweetalert.min.js"></script>
<script src="~/assets/plugins/parsleyjs/dist/parsley.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>



<style>
    .btn-custom-height {
        height: 35px;
        padding: 6px 10px;
        font-size: 14px;
    }

    .error {
        color: red;
    }
</style>


<style>
    #loading {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(255,255,255,0.8);
        z-index: 1000;
    }

    #loadingcontent {
        display: table;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
    }

    #loadingspinner {
        display: table-cell;
        vertical-align: middle;
        width: 100%;
        text-align: center;
        font-size: larger;
        padding-top: 80px;
    }

    .important {
        color: red;
        margin-left: 5px; /* Optional: Add some space between the label text and the asterisk */
    }

    .fillError {
        color: red;
    }
</style>

<script src="~/scripts/jquery-1.10.2.min.js"></script>





<div id="content" class="content">
    <!-- begin breadcrumb -->
    @*<ol class="breadcrumb float-xl-right">
            @*<li class="breadcrumb-item"><a href="#" onclick="location.href='@Url.Action("Dashboard","Leader",new { area = "Leader" })'">Dashboard</a></li>
            <li class="breadcrumb-item">
                <a href="#" onclick="location.href='@Url.Action("Dashboard", "Leader", new { area = "Leader" })'">
                    <i class="fas fa-home fa-fw icon-custom"></i> Home
                </a>
            </li>

        </ol>*@
    <!-- end breadcrumb -->
    <!-- begin page-header -->
    @*<h1 class="page-header">Registration Form</h1>*@
    <!-- end page-header -->
    <!-- begin row -->
    <div class="row">
        <div id="list">
            <p class="m-b-10" style="padding-left:10px;">
                <a href="#" onclick="location.href='@Url.Action("LeaderRegisterdMembersList", "LeaderRegisterdMembers",new {area="Leader" })'" class="btn btn-primary btn-sm"><i class="fas fa-lg fa-fw m-r-10 fa-list-ul" style="color:white"></i>Leader Register Members List</a>
            </p>
        </div>
        <!-- begin col-6 -->
        <!-- end col-6 -->
        <!-- begin col-6 -->
        <div class="col-xl-12">
            <!-- begin panel -->
            <div class="panel panel-inverse" data-sortable-id="form-validation-2">
                <!-- begin panel-heading -->
                <div class="panel-heading">
                    <h4 class="panel-title">Registration Creation</h4>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-12">
                            <form action="/Leader/Leader/SaveIndividualCreation" id="NewRegistraion" method="post" data-parsley-validate="true" enctype="multipart/form-data">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                State Name
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.DropDownListFor(m => m.StateFid, new SelectList(ViewBag.GEtStateName, "Id", "Name"), "--Select--", new { @class = "form-control default-select2", id = "MasStateId", @required = "required" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                City Name
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.DropDownListFor(m => m.City, new SelectList(""), "--Select--", new { @class = "form-control default-select2", id = "MasCity", @required = "required" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Area
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.DropDownListFor(m => m.Area, new SelectList(""), "--Select--", new { @class = "form-control default-select2", id = "MasArea", @required = "required" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Church Name
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.DropDownListFor(m => m.MAS_CHC_FID, new SelectList(""), "--Select--", new { @class = "form-control default-select2", id = "MAS_CHC_FID", @required = "required" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Name
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextBoxFor(m => m.IND_Name, new { @class = "form-control", id = "IND_Name", @placeholder = "Enter Full Name", @required = "required", @autocomplete = "off" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Contact No
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextBoxFor(m => m.IND_Mob, new { @class = "form-control", id = "IND_Mob", oninput = "updateField()", maxlength = "10", @value = "+91", pattern = @"\d{10}", @placeholder = "999-999-9999", @required = "required", @autocomplete = "off" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Email ID
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextBoxFor(m => m.IND_Email, new { @class = "form-control", id = "IND_Email", @placeholder = "Enter Email ID", @required = "required", @autocomplete = "off" })
                                                <span class="fillError" id="Email"></span>
                                            </div>
                                        </div>
                                    </div>
                                    @*<div class="col-md-6">
                                            <div class="row mb-15px" style="margin-bottom:15px;">
                                                <label class="form-label col-form-label col-md-4">
                                                    Aadhar No
                                                    <span class="important">*</span>
                                                </label>
                                                <div class="col-md-8">
                                                    @Html.TextBoxFor(m => m.MemberAdharNo, new { @class = "form-control", id = "AdharNo", type = "text", maxlength = "12", pattern = "[0-9]*", placeholder = "Enter Adhar No", @required = "required", @autocomplete = "off" })
                                                </div>
                                            </div>
                                        </div>*@
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Date Of Birth
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextBoxFor(m => m.IND_DOB, new { @class = "form-control", id = "IND_DOB", @type = "date", @required = "required" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Gender
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.DropDownListFor(m => m.Gender, new List<SelectListItem>
                                               {/*new SelectListItem { Text="All",Value="All" },*/
                                                   new SelectListItem { Text="Male",Value="Male" },
                                                   new SelectListItem { Text="Female",Value="Female" },
                                                      new SelectListItem { Text="Other",Value="Other" },

                                               }, "--Select--", new { @class = "form-control", name = "Type", id = "dllGender" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Address
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextAreaFor(m => m.IND_Address, new { @class = "form-control", id = "IND_Address", @placeholder = "Enter Address", @required = "required", @autocomplete = "off" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                Upload Image
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-6">
                                                @*<input type="file" name="file" data-max-size="32154" accept=".png,.jpeg, .jpg" id="file" value="" class="form-control" />*@
                                                <input type="file" name="file" data-max-size="32154" accept=".png,.jpeg,.jpg" id="file" class="form-control" required onchange="showImage(event)" />
                                                <span class="fillError" id="fillerro"></span>
                                            </div>
                                            <div class="col-md-2">
                                                <img id="imagePreview" src="" alt="Image Preview" style="display:none; max-width: 64px;" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                User ID
                                                <span class="important">*</span>
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextBoxFor(m => m.U_ID, new { @class = "form-control", id = "UserName", @placeholder = "Enter User Name", @readonly = "readonly", autocomplete = "off" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row mb-15px" style="margin-bottom:15px;">
                                            <label class="form-label col-form-label col-md-4">
                                                User Password
                                            </label>
                                            <div class="col-md-8">
                                                @Html.TextBoxFor(m => m.U_Pass, new { @class = "form-control", id = "U_Pass", type = "password", @placeholder = "Enter Password", @Value = "EKS@1921@", @required = "required", @readonly = "readonly", autocomplete = "off" })
                                                <button type="button" id="ShowPassword" class="btn btn-default btnpress" style="position:absolute; top:0; right:0; height:100%; color:blue; background-color:lightgray; border:1px solid lightslategray;">
                                                    <i class="fa fa-eye" style="font-size:small; font-weight: bold; color:blue;"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr />
                                <div class="text-center">
                                    <button type="button" id="btnSave" class="btn btn-sm btn-primary m-r-5 btn-custom-height">Register</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        debugger

        $("#dllGender").select2();
        $("#MasStateId").select2();
        $("#MasCity").select2();
        $("#MAS_CHC_FID").select2();
        $("#MasArea").select2();


        var Message=@(Html.Raw(Json.Encode(TempData["Message"])));
        var Icon=@(Html.Raw(Json.Encode(TempData["Icon"])));
        if (Message!=null) {
            if(Icon!=null)
            {
                //swal("",Message,Icon);
                Swal.fire({
                    title: '',
                    text: Message,
                    icon: Icon,
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });
            }

        }

        $("#MasStateId").on("change", function () {
            debugger;
            $("#MasCity").find("option").remove();
            var StateId = $("#MasStateId").val();
            $.ajax({
                type: 'GET',
                dataType: 'JSON',
                contentType: "application/json; charset=utf-8",
                url: '@Url.Action("GetCity", "Leader")',
                data: { StateId: StateId },
                success: function (data) {
                    debugger;
                    if (data != null) {
                        //var data1 = data.data;
                        $("#MasCity").append("<option value=''>--Select-- </option>");
                        $.each(data, function (i, p) {
                            $("#MasCity").append("<option value='" + p.Name + "'>" + p.Name + "</option>");
                        });
                    }
                    else {
                        $('#ErrorESSPassword').html(" ");
                    }
                }
            })

        });


        $("#MasCity").on("change", function () {
            debugger;
            $("#MasArea").find("option").remove();
            var MasCityName = $("#MasCity").val();
            var StateId = $("#MasStateId").val();
            $.ajax({
                type: 'GET',
                dataType: 'JSON',
                contentType: "application/json; charset=utf-8",
                url: '@Url.Action("GetArea", "Leader")',
                data: {StateId:StateId, MasCityName: MasCityName },
                success: function (data) {
                    debugger;
                    if (data != null) {
                        var GetArea  = data.Data;
                        var GetChurch=data.GetChurch;
                        if(GetArea!=null)
                        {
                            $("#MasArea").append("<option value=''>--Select--</option>");
                            $.each(GetArea, function (i, p) {
                                $("#MasArea").append("<option value='" + p.Name + "'>" + p.Name + "</option>");
                            });
                        }
                        if(GetChurch!=null)
                        {
                            //$("#MAS_CHC_FID").append("<option value=''>--Select--</option>");
                            $.each(GetChurch, function (i, p) {
                                $("#MAS_CHC_FID").append("<option value='" + p.Id + "'>" + p.Name + "</option>");
                            });
                        }

                    }
                    else {
                        $('#ErrorESSPassword').html(" ");
                    }
                }
            })

        });


        //var today = new Date();
        //var formattedDate = today.getFullYear() + '-' + ('0' + (today.getMonth() + 1)).slice(-2) + '-' + ('0' + today.getDate()).slice(-2);
        //var CheckEmptyDate = document.getElementById('IND_DOB').value;
        //if (CheckEmptyDate == "") {
        //    document.getElementById('IND_DOB').value = formattedDate;
        //}


        //Space Not Allowed
        $('#IND_Mob').on('input', function (e) {
            debugger;
            var input = $(this).val();
            if (e.which == 32) {

                Swal.fire({
                    title: '',
                    text: "Space not Allowed",
                    icon: "error",
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });
                return false;
            }
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57))
            {
                //swal("", "Enter Only Digits", "error");
                Swal.fire({
                    title: '',
                    text:"Enter Only Digits",
                    icon: "error",
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });
                return false;
            }
            if (!/^\d*$/.test(input)) {
                Swal.fire({
                    title: '',
                    text: "Enter Only Digits",
                    icon: "error",
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });

                $(this).val(input.replace(/\D/g, '')); // Remove non-digit characters from input
                return false;
            }
            $("#UserName").val(input);

        });

        $('#IND_Mob').on('keydown', function (e) {
            if (e.which == 8) { // Backspace key
                $("#UserName").val('');
            }
        })

        $('#IND_Email').on('keypress', function (e) {
            if (e.which == 32) {
                Swal.fire({
                    title: '',
                    text: "Space not Allowed",
                    icon: "error",
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });
                return false;
            }

        });



        $('#AdharNo').on('keypress', function (e) {
            debugger

            if (e.which == 32) {
                //swal("", "Space not Allowed", "error");
                Swal.fire({
                    title: '',
                    text: "Space not Allowed",
                    icon: "error",
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });
                return false;
            }
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57))
            {

                Swal.fire({
                    title: '',
                    text: "Enter Only Digits",
                    icon: "error",
                    confirmButtonColor: '#3085d6',
                    confirmButtonText: 'Ok'
                });
                return false;
            }

        });

        $("#file").change(function () {
            debugger;
            $("#fillerro").html("");
        })
        $("#IND_Email").click(function () {
            debugger;
            $("#Email").html("");
        })



        $("#btnSave").click(function(){
            debugger;
            var form = $('#NewRegistraion');
            var today = new Date();
            var dob = new Date($("#IND_DOB").val());
            var age = Math.floor((today-dob) / (365.25 * 24 * 60 * 60 * 1000));

            var fileInput = document.getElementById('file');
            if (fileInput && fileInput.value) {
                var validExtensions = ['.png', '.jpg', '.jpeg'];
                var filePath = fileInput.value.toLowerCase(); // Convert to lowercase for case-insensitive comparison
                var fileExtension = filePath.substring(filePath.lastIndexOf('.') + 1); // Get the file extension without '.'

                if (validExtensions.indexOf('.' + fileExtension) === -1) {
                    Swal.fire({
                        title: '',
                        text: "Only PNG, JPG, and JPEG files are allowed.",
                        icon: "warning",
                        confirmButtonColor: '#3085d6',
                        confirmButtonText: 'Ok'
                    });
                    fileInput.value = ''; // Clear the file input
                    return false; // Prevent form submission or further processing
                }
            }else{
                $("#fillerro").html("select  profile image");

                return false;
            }

            //if(age < 18)
            //{
            //    Swal.fire({
            //        title: '',
            //        text: "Age should be minimum 18",
            //        icon: "error",
            //        confirmButtonColor: '#3085d6',
            //        confirmButtonText: 'Ok'
            //    });

            //    $("#IND_DOB").css('border-color', 'red');
            //    //$("#DoB").after('<span class="red"></span>');
            //    $("#loading").fadeOut();

            //    return false;

            //}
            //else {
            //    $("#IND_DOB").css('border-color', '');

            //}

            //var AdharLenght = $("#AdharNo").val().length;
            //if (AdharLenght >12 && AdharLenght!=0 ) {
            //    Swal.fire({
            //        title: '',
            //        text: "Adhar No Should Not be More Then 12 Digits",
            //        icon: "error",
            //        confirmButtonColor: '#3085d6',
            //        confirmButtonText: 'Ok'
            //    });
            //    //swal("", "Adhar No Should Not be More Then 12 Digits", "error");
            //    $("#AdharNo").css('border-color', 'red');
            //    $("#loading").fadeOut();
            //    return false;
            //}

            //if(AdharLenght <12 && AdharLenght!=0){
            //    Swal.fire({
            //        title: '',
            //        text:  " Adhar No Should Not be less than 12 Digits",
            //        icon: "error",
            //        confirmButtonColor: '#3085d6',
            //        confirmButtonText: 'Ok'
            //    });

            //    $("#AdharNo").css('border-color', 'red');
            //    $("#loading").fadeOut();
            //    return false;
            //}
            var MobileNumber=$("#IND_Mob").val();
            var Email=$("#IND_Email").val();
            //var AdharNumber=$("#AdharNo").val();
            $.ajax({
                url: '@Url.Action("IsExistsData", "Leader",new { area= "Leader" })',
                method:"get",
                data:{Email:Email,MobileNumber:MobileNumber},
                success:function(response){
                    debugger;
                    var Message1 = response.Message;
                    var Icon1 = response.Icon;
                    if (response.Icon=="error") {
                        $(".Userloaderbg").css("display", "none");
                        if (Message1 != null) {
                            if (Message1 != null) {
                                if(Message1=="Email Already Exist")
                                {
                                    $("#Email").html(Message1);
                                    $("#IND_Email").css("border", "1px solid red");

                                    return false;
                                }else{
                                    Swal.fire({
                                        title: '',
                                        text: Message1,
                                        icon: Icon1,
                                        confirmButtonColor: '#3085d6',
                                        confirmButtonText: 'Ok'
                                    });
                                }
                            }
                        }
                    }
                    else{
                        if (form[0].checkValidity()) {
                            $(".Userloaderbg").css("display", "flex");

                        }
                        $("#NewRegistraion").submit();
                    }
                }
            });
        });
    });

</script>
<script>
    $('#ShowPassword').click(function() {
        debugger;
        var passwordInput = $('#U_Pass');
        var buttonIcon = $('#ShowPassword i');

        // Toggle password visibility
        if (passwordInput.attr('type') === 'password') {
            passwordInput.attr('type', 'text');
            buttonIcon.removeClass('fa-eye').addClass('fa-eye-slash'); // Change icon to 'eye-slash' icon
        } else {
            passwordInput.attr('type', 'password');
            buttonIcon.removeClass('fa-eye-slash').addClass('fa-eye'); // Change icon back to 'eye' icon
        }
    });
</script>
<script>
    function showImage(event) {
        const fileInput = event.target;
        const file = fileInput.files[0];

        if (file) {
            const reader = new FileReader();

            reader.onload = function(e) {
                const imagePreview = document.getElementById('imagePreview');
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block'; // Show the image
            }

            reader.readAsDataURL(file); // Convert the file to a DataURL (Base64)
        }
    }
</script>
